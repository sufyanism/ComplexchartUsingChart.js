<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Complex Chart.js with External Excel Data</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<style>
  body{
        font-family: Arial, sans-serif;
    margin: 40px;
    text-align: center;
  }
  #chartContainer {
    width: 90%;
    max-width: 800px;
    margin: auto;
  }

/* Heading */
/* === BASE HEADING === */ 
h1 {
  position: relative;
  padding: 0;
  margin: 0;
  font-family: "Raleway", sans-serif;
  font-weight: 300;
  font-size: 32px;
  color: #080808;
  -webkit-transition: all 0.4s ease 0s;
  -o-transition: all 0.4s ease 0s;
  transition: all 0.4s ease 0s;
}

h1 span {
  display: block;
  font-size: 0.5em;
  line-height: 1.3;
}
h1 em {
  font-style: normal;
  font-weight: 600;
}

/* === HEADING STYLE #1 === */
.one{
    padding-bottom: 20px;
}
.one p {
  font-size: 20px;
}
.one h1 {
  text-align: center;
  padding-bottom: 5px;
}
.one h1:before {
  width: 28px;
  height: 5px;
  display: block;
  content: "";
  position: absolute;
  bottom: 3px;
  left: 50%;
  margin-left: -14px;
  background-color: #b80000;
}
.one h1:after {
  width: 100px;
  height: 1px;
  display: block;
  content: "";
  position: relative;
  margin-top: 25px;
  left: 50%;
  margin-left: -50px;
  background-color: #b80000;
}
</style>

</head>
<body>

<div class="one">
  <h1>Load Data from External XLSX</h1>
  <p> zeba.academy </p>
</div>

<div id="chartContainer">
  <canvas id="myChart"></canvas>
</div>
<script>
const ctx = document.getElementById('myChart').getContext('2d');
let myChart = null; // To hold the chart instance

// Function to handle file upload and parse data
// Function to load data and create chart
function loadAndCreateChart() {
  fetch('Dummy.xlsx') // Replace with your actual filename or URL
    .then(res => res.arrayBuffer())
    .then(data => {
      const workbook = XLSX.read(data, { type: 'array' });
      const sheetName = workbook.SheetNames[0];
      const worksheet = workbook.Sheets[sheetName];
      const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
      if (jsonData.length < 2) {
        alert('Sheet does not have enough data.');
        return;
      }
      const headers = jsonData[0];
      const rows = jsonData.slice(1);
      const labels = [];
      const grade1 = [], grade2 = [], grade3 = [];

      rows.forEach(row => {
        labels.push(row[0]);
        grade1.push(parseFloat(row[1]));
        grade2.push(parseFloat(row[2]));
        grade3.push(parseFloat(row[3]));
      });
      // Function to generate chart from data
function createChart(labels, grade1, grade2, grade3) {
  if (myChart) myChart.destroy(); // Destroy previous chart if exists

  // Create gradients
  const gradient1 = ctx.createLinearGradient(0, 0, 0, 400);
  gradient1.addColorStop(0, 'rgba(255, 99, 132, 0.6)');
  gradient1.addColorStop(1, 'rgba(255, 99, 132, 0)');
  const gradient2 = ctx.createLinearGradient(0, 0, 0, 400);
  gradient2.addColorStop(0, 'rgba(54, 162, 235, 0.6)');
  gradient2.addColorStop(1, 'rgba(54, 162, 235, 0)');

  myChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: labels,
      datasets: [
        {
              label: headers[1] || 'Dataset 1',
          data: grade1,
        backgroundColor: 'rgba(75, 192, 192, 0.2)',
        borderColor: 'rgba(75, 192, 192, 1)',
        borderWidth: 1,
        type: 'pie', // specifies this dataset is a pie
        yAxisID: 'y', // links to primary Y axis
        barThickness: 40,
        },
        {
              label: headers[2] || 'Dataset 2',
          data: grade2,
        borderColor: 'rgba(255, 99, 132, 1)',
        backgroundColor: 'rgba(255, 99, 132, 0.2)',
        fill: false,
        pointBackgroundColor: 'rgba(255, 99, 132, 1)',
        pointBorderColor: '#fff',
        pointHoverBackgroundColor: '#fff',
        pointHoverBorderColor: 'rgba(255, 99, 132, 1)',
        borderWidth: 2,
        type: 'line', // specifies this dataset is a line
        yAxisID: 'y1', // links to secondary Y axis
        },
        {
              label: headers[3] || 'Dataset 3',
          data: grade3,
        borderColor: 'rgba(54, 162, 235, 1)',
        backgroundColor: 'rgba(54, 162, 235, 0.2)',
        fill: false,
        pointBackgroundColor: 'rgba(54, 162, 235, 1)',
        pointBorderColor: '#fff',
        pointHoverBackgroundColor: '#fff',
        pointHoverBorderColor: 'rgba(54, 162, 235, 1)',
        borderWidth: 2,
        type: 'line',
        yAxisID: 'y1',
        }
      ]
    },

  options: {
    responsive: true,
    interaction: {
      mode: 'index',
      intersect: false,
    },
    stacked: false,
    plugins: {
      tooltip: {
        mode: 'index',
        intersect: false,
      },
      legend: {
        position: 'top',
      },
    },
    scales: {
              x: {
              title: {
                display: true,
                text: headers[0] || 'Label',
                font: {
                  size: 16,
                  weight: 'bold'
                }
              },
              grid: {
                display: false
              }
            },
      y: {
        type: 'linear',
        display: true,
        position: 'left',
        title: {
          display: true,
                text: headers[1] || 'Label',
        },
        grid: {
          drawOnChartArea: false,
        },
        beginAtZero: true,
      },
      y1: {
        type: 'linear',
        display: true,
        position: 'right',
        title: {
          display: true,
                text: headers[2] || 'Label',
        },
        grid: {
          drawOnChartArea: false,
        },
        beginAtZero: true,
      },
    },
  },    
  });
}
      createChart(labels, grade1, grade2, grade3);
    })
    .catch(err => {
      console.error('Error loading or processing Excel:', err);
    });
}

// Call this function immediately after defining it
loadAndCreateChart();




</script>
</body>
</html>